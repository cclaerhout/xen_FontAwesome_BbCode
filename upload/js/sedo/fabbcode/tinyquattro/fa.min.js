xenMCE.Templates.Bbm_fa={getFaOptions:function(){var f=["fa-lg","fa-2x","fa-3x","fa-4x","fa-5x"],u=["pull-right","pull-left"],e=["fa-rotate-90","fa-rotate-180","fa-rotate-270"],r=["fa-stack","fa-stack-1x","fa-stack-2x","fa-inverse"],o=["fa-stack-1x","fa-stack-2x"],n=["fa-flip-horizontal","fa-flip-vertical"],t=["fa-fw","fa-border","fa-spin"],i=$.merge($.merge([],f),u);return $.each([e,r,n,t],function(n,t){$.merge(i,t)}),{size:f,pull:u,rotate:e,stack:r,stackSize:o,flip:n,misc:t,faAll:i}},intersect:function(n,t,i){var f=!1,u=[],r=$.grep(n,function(n){return $.inArray(n,t)>-1});return $.each(r,function(t,r){var e=$.inArray(r.toString(),n);i===!0&&e!==-1&&(n.splice(e,1),f=!0),u.push(e)}),{array:{keys:u,vals:r},string:{keys:u.toString(),vals:r.toString()},altered:f}},deleteValFromArray:function(n,t,i){var f=this,u=!0,r=[];if($.isArray(t))u=!1;else if(typeof t!="string")return r;return(u?$.each(n,function(n,i){i!=t&&r.push(i)}):$.each(n,function(n,i){$.inArray(i,t)===-1&&r.push(i)}),typeof i=="undefined")?r:(typeof i=="string"&&(i=[i]),$.each(i,function(n,i){$.inArray(i,t)===-1&&r.push(i)}),r)},onafterload:function(n,t,i,r){function ft(n){if(!n)return[];var t=[];return $.inArray(n,o.size)!==-1&&(t=f.deleteValFromArray(o.size,n)),$.inArray(n,o.pull)!==-1&&(t=f.deleteValFromArray(o.pull,n)),$.inArray(n,o.rotate)!==-1&&(t=f.deleteValFromArray(o.rotate,n),$.merge(t,o.flip)),$.inArray(n,o.stackSize)!==-1&&(t=f.deleteValFromArray(o.stackSize,n)),$.inArray(n,o.flip)!==-1&&(t=o.rotate),t}function a(n,t){var r;if(typeof n=="undefined")return!1;var i=f.protectedData[t],e=$.inArray(n,i)!==-1,u=!1;return e?i=f.deleteValFromArray(i,n):(r=ft(n),i.push(n),r.length&&(i=f.deleteValFromArray(i,r)),u=!0),f.protectedData[t]=i,u}function l(t,i){return i=(typeof i=="undefined"||i==!0)&&i!="disable"?"enable":"disable",n.find(t).jAutochecklist(i)}function vt(n){var t="locked",n=n?1:0;f.stackMode=n,l("#"+s+"_2",n),e.$stack.val(n),n?b.removeClass(t):(b.addClass(t),st())}function c(n,t,i,r,u){return n.jAutochecklist(t,i,r,u)}function wt(n){function e(n){switch(n){case i:return r;case r:return i}}var i="fa-stack-1x",r="fa-stack-2x",u;if(!n)return c(y,"unset",[i,r]),!1;var h={1:i,2:r},o=c(rt,"get"),s=c(w,"get"),f=empty_l2=!0,t={l1:{},l2:{}};if($.each(h,function(n,i){var u=$.inArray(i,o),r=$.inArray(i,s);t.l1[n]=u!==-1,t.l2[n]=r!==-1,u!==-1&&(t.l1.val=o[u]),r!==-1&&(t.l2.val=s[r])}),(t.l1[1]||t.l1[2])&&(f=!1),(t.l2[1]||t.l2[2])&&(empty_l2=!1),f&&empty_l2){a(r,"opt1"),a(i,"opt2"),c(rt,"set",[r]),c(w,"set",[i]);return}if(f&&!empty_l2){u=e(t.l2.val),a(u,"opt1"),c(rt,"set",u);return}if(empty_l2&&!f){u=e(t.l1.val),a(u,"opt2"),c(w,"set",e(t.l1.val));return}}function h(t){return n.find('input[name="'+t+'"]')}function pt(){yt(),ot(),ut(),f.stackMode=!1,y.jAutochecklist("deselectAll"),f.protectedData={icons:[],opt1:[],opt2:[]}}function yt(){l("#"+s+"_1, #"+s+"_2",!1)}function ot(){$.each(e,function(n,t){var i="",r=t.attr("name");switch(r){case"bbmFaStack":i=0;break;case"bbmFaPos":i="left";break;case"bbmFaText":i=it;break;case"bbmFaColor1":return;case"bbmFaColor2":return}t.val(i)})}function ut(){u.$solo.show().children().removeClass(),u.$stack.hide(),$.each(u.stack,function(n,t){t.removeClass()})}function st(n){f.protectedData.opt1=f.deleteValFromArray(f.protectedData.opt1,o.stackSize),e.$b2.val(""),e.$optRoot.val(""),c(w,"unset",f.protectedData.opt2),f.protectedData.opt2=[],n==!0&&(l("#"+s+"_2",!1),ut())}function ht(n){var s=f.intersect(n,o.size,!0),i,t,r;if(s.altered)return i=s.string.vals,t=e.$optRoot.val(),t=t.length?t.split(","):[],f.intersect(t,o.size,!0),t.push(i),e.$optRoot.val(t),r=u.stack.$root,$.each(o.size,function(n,t){r.removeClass(t)}),r.addClass(i),i}var lt=r.getSelection(),dt=lt.text,bt=xenMCE.Phrases,f=this,at="fa_list",s="fa_options",kt="options_wrapper",et="jAutochecklist",p=et+"_wrapper",gt=et+"_popup",k=xenMCE.Phrases.Fa,it=k.textInput,o=this.getFaOptions(),tt=n.find("#"+at),y=n.find("."+s),v="preview_fa",e={$b1:h("bbmFaBtn1"),$b2:h("bbmFaBtn2"),$opt1:h("bbmFaOpt1"),$opt2:h("bbmFaOpt2"),$optRoot:h("bbmFaOptRoot"),$pos:h("bbmFaPos"),$text:h("bbmFaText"),$stack:h("bbmFaStack"),$color1:h("bbmFaColor1"),$color2:h("bbmFaColor2")},u={$container:n.find("#"+v),$text:n.find("#"+v+"_txt"),$solo:n.find("#"+v+"_solo"),$stack:n.find("#"+v+"_stack"),$align:n.find("#"+v+"_align"),$colpick1:n.find("#bbm_fa_colpick_1"),$colpick2:n.find("#bbm_fa_colpick_2")},g,nt,ct;u.stack={$root:u.$stack.children("span"),$b1:u.$stack.find("i").eq(0),$b2:u.$stack.find("i").eq(1)},this.stackMode=!1,this.itemClickCallBack=!1,this.protectedData={icons:[],opt1:[],opt2:[]},g={multiple:!0,popup:!0,popupMaxItem:2,listMaxHeight:100,width:250,popupSizeDelta:0,popupLogoAsValue:!0,htmlResults:!0,sortValues:!0,popupLogoClassRegexFind:/fa-(lg|2x|3x|4x|5x)/gi,onItemClick:function(){var h=tt.jAutochecklist("count"),v=tt.jAutochecklist("get"),p=h>0,o=!1,f="",c="",a;if(l("#"+s+"_1",p),h==1)b.addClass("locked"),f=v[0];else if(h==2)o=!0,b.removeClass("locked"),f=v[0],c=v[1];else if(h>2)return!1;if(vt(o),o){var a=e.$b1.val(),w=e.$b2.val(),y="";u.stack.$root.addClass("fa-stack"),u.stack.$b1.removeClass(a).addClass("fa "+f+y),u.stack.$b2.removeClass(w).addClass("fa "+c+y),u.$solo.hide(),u.$stack.show(),e.$b1.val(f),e.$b2.val(c)}else a=e.$b1.val(),u.$solo.children("i").removeClass(a).addClass("fa "+f),u.$stack.hide(),u.$solo.show(),e.$b1.val(f);wt(o)},onRemoveAll:function(){pt()}},nt={multiple:!0,popup:!0,listMaxHeight:100,width:250,popupSizeDelta:0,sortValues:!0,groupType:4,showResultsAsText:!0,sortValues:!0,onItemClick:function(t,i){var l=i.parents("."+p),h=1+d.index(l),v=n.find("#"+s+"_"+h),y=!i.hasClass("selected"),c=a(t,"opt"+h),o;f.itemClickCallBack=!1,c&&(o=ft(t),o.length&&(f.itemClickCallBack={$src:v,toDelete:o,toAdd:t}))},onUpdateComplete:function(n,t){var h=1+y.index(t.originalList),l="opt"+h,i,r,a,o,n=f.protectedData[l],s;if(f.stackMode)h==1?(ht(n),i=u.stack.$b1,o=e.$opt1,r=e.$b1.val()):(i=u.stack.$b2,o=e.$opt2,r=e.$b2.val());else if(h==1)i=u.$solo.children("i"),o=e.$opt1,r=e.$b1.val();else return!1;r&&i.removeClass().addClass("fa "+r),n.length&&$.each(n,function(n,t){i.addClass(t)}),o.val(n),f.itemClickCallBack!=!1&&(s=$.extend({},f.itemClickCallBack),f.itemClickCallBack=!1,c(s.$src,"unset",s.toDelete))},onRemoveAll:function(n,t){var o=n.parents("."+p),i=1+d.index(o),r="opt"+i,t=f.protectedData[r];f.stackMode?i==1?($target=u.stack.$b1,e.$opt1.val("")):($target=u.stack.$b2,e.$opt2.val("")):($target=u.$solo.children("i"),e.$opt1.val("")),$.each(t,function(n,t){$target.removeClass(t)}),f.protectedData[r]=[]}},$.extend(g,k),$.extend(nt,k),tt.jAutochecklist(g),y.jAutochecklist(nt);var rt=l("#"+s+"_1",!1),w=l("#"+s+"_2",!1),d=n.find("."+p+"."+s),b=d.children("ul").children().filter(function(){return $(this).data("name")=="stack"});e.$text.one("focus",function(){$(this).val("")}).focus(function(){$(this).val()==it&&$(this).val("")}).focusout(function(){$(this).val().length==0&&$(this).val(it)}),u.$align.click(function(){function s(){r.removeClass(f+" "+o)}var h=$(this).children(),c=h.eq(0),r=h.eq(1),t="left",i="right",f="fa-align-"+t,o="fa-align-"+i;r.hasClass(f)?(s(),r.addClass(o),e.$pos.val(i),u.$text.appendTo(u.$container).removeClass(t).addClass(i)):(s(),r.addClass(f),e.$pos.val(t),u.$text.prependTo(u.$container).removeClass(i).addClass(t))}),ct=n.find(".bbm_fa_colpick").colpick({colorScheme:"dark",layout:"hex",color:"ff8800",onSubmit:function(t,i,r,f){var o=$(f);(index=n.find(".bbm_fa_colpick").index(o),color="#"+i,index++,index!=0)&&(index==1&&(e.$color1.val(color),u.$solo.children("i").css("color",color),u.stack.$b1.css("color",color)),index==2&&(e.$color2.val(color),u.stack.$b2.css("color",color)),o.find("i").last().css("color",color),o.colpickHide())},onShow:function(n){var t=$(n);t.css({zIndex:65550,height:"230px"}),$raz=$('<div class="bbm_fa_color_raz">'+k.resetColor+"</div>"),$raz.click(function(){var f=$(this),i=f.parent(),r=i.prev(".colpick").length,t=r?2:1;t!=0&&(t==1&&(e.$color1.val(""),u.$solo.children("i").css("color",""),u.stack.$b1.css("color",""),u.$colpick1.find("i").last().css("color",""),u.$colpick1.colpickHide()),t==2&&(e.$color2.val(""),u.stack.$b2.css("color",""),u.$colpick2.find("i").last().css("color",""),u.$colpick2.colpickHide()))}),$raz.appendTo(t)}})},submit:function(n,t,i,r){function e(){i.windowManager.alert(k.missingAlert)}var rt=this.getFaOptions(),k=xenMCE.Phrases.Fa,it=k.textInput,b=r.bbm_tag,tt=r.bbm_separator,f=n.data,w=parseInt(f.bbmFaStack),p=f.bbmFaBtn1.split(","),a=f.bbmFaBtn2.split(","),d=f.bbmFaOptRoot.split(","),g=f.bbmFaOpt1.split(","),h=f.bbmFaOpt2.split(","),c=f.bbmFaText!=it?r.escapeHtml(f.bbmFaText):"",nt=f.bbmFaPos=="left",o=f.bbmFaColor1||"",s=f.bbmFaColor2||"",v="",y,l,u=[];if(w&&d.length&&$.merge(u,d),p.length)o.length&&u.push(o),$.merge(u,p),g.length&&$.merge(u,g);else return e(),!1;if(w)if(u.push("fa-stack"),a.length)s.length&&u.push(s),$.merge(u,a),h.length&&$.merge(u,h);else return e(),!1;if(c.length&&nt&&u.push("left"),u=$.grep(u,function(n){return n}),u=u.join(tt),y="["+b+"="+u+"]",l="[/"+b+"]",v=y+c+l,!u||u=="left")return e(),!1;i.execCommand("mceInsertContent",!1,v)},onclose:function(n,t){t.find(".bbm_fa_colpick").each(function(){var n=$(this).data("colpickId");n&&$("#"+n).remove()})}};